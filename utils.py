import re

# Top 100 ports (same as README table)
TOP_100_PORTS = [
    20,21,22,23,25,53,67,68,69,80,110,111,119,123,135,137,138,139,143,
    161,162,179,194,389,427,443,445,465,500,512,513,514,515,520,546,547,
    554,563,587,631,636,873,902,989,990,993,995,1025,1080,1194,1433,1434,
    1521,1723,1883,2049,2121,2181,2375,2376,2483,2484,2638,3000,3128,3260,
    3306,3389,3478,3632,3690,4369,4444,4505,4506,4567,5000,5001,5044,5060,
    5061,5222,5432,5555,5601,5631,5672,5683,5900,5938,5985,5986,6000,6379,
    6443,6666,6667,7001,7002,7199,7443,7676,7777,8000,8008,8080,8081,8086,
    8088,8090,8161,8333,8443,8500,8545,8585,8672,8888,9000,9001,9042,9090,
    9092,9200,9300,9418,9443,9600,9999,10000,11211,15672,27017
]

def normalize_subdomain(sub: str) -> str:
    """
    Lowercase, strip trailing dots and whitespace.
    """
    if not sub:
        return ""
    return re.sub(r"\.$", "", sub.strip().lower())

def chunk_list(lst: list, n: int):
    """
    Yield successive n-sized chunks from a list.
    Useful for batching async requests.
    """
    for i in range(0, len(lst), n):
        yield lst[i:i+n]
